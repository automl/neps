
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cfg/">
      
      
        <link rel="next" href="../crossover/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Core graph grammar - NePS</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#neps.search_spaces.architecture.core_graph_grammar" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="NePS" class="md-header__button md-logo" aria-label="NePS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NePS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core graph grammar
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/automl/neps" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    automl/neps
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../getting_started/" class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../reference/neps_run/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../examples/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../dev_docs/contributing/" class="md-tabs__link">
          
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../citations/" class="md-tabs__link">
        
  
    
  
  Cite

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="NePS" class="md-nav__button md-logo" aria-label="NePS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    NePS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/automl/neps" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    automl/neps
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../reference/neps_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../reference/pipeline_space/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Search Space
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../reference/optimizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../reference/declarative_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Declarative Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../reference/run_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Run Function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../reference/analyse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analysing Runs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basic usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/basic_usage/analyse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analyse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/basic_usage/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/basic_usage/architecture_and_hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture and hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/basic_usage/hpo_usage_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hpo usage example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/basic_usage/hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Convenience
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Convenience
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/convenience/logging_additional_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging additional info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/convenience/neps_tblogger_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neps tblogger tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/convenience/neps_x_lightning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neps x lightning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/convenience/working_directory_per_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working directory per pipeline
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Declarative usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Declarative usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/declarative_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Declarative Usage in NePS for Neural Network Optimization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/declarative_usage/hpo_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hpo example
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Efficiency
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Efficiency
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/efficiency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/efficiency/expert_priors_for_hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expert priors for hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/efficiency/multi_fidelity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi fidelity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/efficiency/multi_fidelity_and_expert_priors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi fidelity and expert priors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Experimental
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Experimental
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/experimental/cost_aware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cost aware
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/experimental/expert_priors_for_architecture_and_hyperparameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expert priors for architecture and hyperparameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/experimental/fault_tolerance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fault tolerance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/experimental/hierarchical_architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hierarchical architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/experimental/hierarchical_architecture_hierarchical_GP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hierarchical architecture hierarchical GP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/experimental/user_priors_from_arbitrary_densities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User priors from arbitrary densities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Template
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Template
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/template/basic_template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/template/lightning_template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lightning template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/template/priorband_template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Priorband template
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Neps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Neps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Api
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Runtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Optimizers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            Optimizers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/base_optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base optimizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_4" id="__nav_5_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bayesian optimization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Bayesian optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/cost_cooling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cost cooling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/mf_tpe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mf tpe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_4_4" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_4_4" id="__nav_5_2_3_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Acquisition functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_4_4">
            <span class="md-nav__icon md-icon"></span>
            Acquisition functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_functions/base_acquisition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base acquisition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_functions/cost_cooling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cost cooling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_functions/ei/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ei
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_functions/mf_ei/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mf ei
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_functions/prior_weighted/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prior weighted
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_functions/ucb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ucb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_4_5" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_4_5" id="__nav_5_2_3_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Acquisition samplers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_4_5">
            <span class="md-nav__icon md-icon"></span>
            Acquisition samplers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_samplers/base_acq_sampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base acq sampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_samplers/evolution_sampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evolution sampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_samplers/freeze_thaw_sampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Freeze thaw sampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_samplers/mutation_sampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mutation sampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/acquisition_samplers/random_sampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Random sampler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_4_6" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_4_6" id="__nav_5_2_3_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kernels
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_4_6">
            <span class="md-nav__icon md-icon"></span>
            Kernels
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/combine_kernels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Combine kernels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/combine_kernels_hierarchy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Combine kernels hierarchy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/get_kernels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get kernels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/graph_kernel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph kernel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/vectorial_kernels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vectorial kernels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/weisfilerlehman/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weisfilerlehman
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_4_6_9" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_4_6_9" id="__nav_5_2_3_4_6_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grakel replace
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_2_3_4_6_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_4_6_9">
            <span class="md-nav__icon md-icon"></span>
            Grakel replace
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/grakel_replace/edge_histogram/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Edge histogram
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/grakel_replace/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/grakel_replace/vertex_histogram/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vertex histogram
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/kernels/grakel_replace/weisfeiler_lehman/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weisfeiler lehman
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_4_7" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_4_7" id="__nav_5_2_3_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_4_7">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/models/deepGP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deepGP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/models/gp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/bayesian_optimization/models/gp_hierarchy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gp hierarchy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_5" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_5" id="__nav_5_2_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grid search
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Grid search
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/grid_search/optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_6" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_6" id="__nav_5_2_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multi fidelity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_6">
            <span class="md-nav__icon md-icon"></span>
            Multi fidelity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/dyhpo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dyhpo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/hyperband/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperband
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/mf_bo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mf bo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/promotion_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Promotion policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/sampling_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/successive_halving/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Successive halving
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_7" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_7" id="__nav_5_2_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multi fidelity prior
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_7">
            <span class="md-nav__icon md-icon"></span>
            Multi fidelity prior
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity_prior/async_priorband/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async priorband
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity_prior/priorband/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Priorband
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multi_fidelity_prior/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_8" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_8" id="__nav_5_2_3_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multiple knowledge sources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_8">
            <span class="md-nav__icon md-icon"></span>
            Multiple knowledge sources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/multiple_knowledge_sources/prototype_optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype optimizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_9" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_9" id="__nav_5_2_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Random search
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_9">
            <span class="md-nav__icon md-icon"></span>
            Random search
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/random_search/optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_10" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_10" id="__nav_5_2_3_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Regularized evolution
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_10">
            <span class="md-nav__icon md-icon"></span>
            Regularized evolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/regularized_evolution/optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_4" >
        
          
          <label class="md-nav__link" for="__nav_5_2_4" id="__nav_5_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Plot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_4">
            <span class="md-nav__icon md-icon"></span>
            Plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../plot/plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../plot/plotting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../plot/read_results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../plot/tensorboard_eval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensorboard eval
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_5" id="__nav_5_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Search spaces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_5">
            <span class="md-nav__icon md-icon"></span>
            Search spaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parameter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../search_space/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Search space
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yaml_search_space_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yaml search space utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_5_4" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_5_4" id="__nav_5_2_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_5_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_5_4">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Api
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cfg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cfg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Core graph grammar
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Core graph grammar
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;core_graph_grammar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core_graph_grammar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CoreGraphGrammar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoreGraphGrammar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.OPTIMIZER_SCOPE" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;OPTIMIZER_SCOPE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.__hash__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__hash__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.add_edges_densly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_edges_densly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.add_node" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.assemble_trees" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;assemble_trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.build_graph_from_tree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;build_graph_from_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.clone" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.compile" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.copy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.forward" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_nxTree_to_stringTree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_nxTree_to_stringTree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_stringTree_to_graph_repr" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_stringTree_to_graph_repr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_stringTree_to_nxTree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_stringTree_to_nxTree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_all_edge_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_all_edge_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_dense_edges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_dense_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_graph_representation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_graph_representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.graph_to_self" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;graph_to_self
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.modules_str" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;modules_str
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.num_input_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;num_input_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.parse" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prepare_discretization" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prepare_discretization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prepare_evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prepare_evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prune_tree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prune_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.reset_weights" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_at_edges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_at_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_input" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_scope" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.to_graph_repr" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_graph_repr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.unparse" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;unparse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.update_edges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.update_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crossover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crossover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph_grammar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph grammar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mutations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mutations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../primitives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Primitives
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topologies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topologies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_5_4_10" >
        
          
          <label class="md-nav__link" for="__nav_5_2_5_4_10" id="__nav_5_2_5_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cfg variants
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_5_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_5_4_10">
            <span class="md-nav__icon md-icon"></span>
            Cfg variants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cfg_variants/cfg_resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cfg resolution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cfg_variants/constrained_cfg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constrained cfg
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_2_5_5" id="__nav_5_2_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hyperparameters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_5_5">
            <span class="md-nav__icon md-icon"></span>
            Hyperparameters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/categorical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Categorical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/constant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/float/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Float
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/integer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameters/numerical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numerical
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_6" >
        
          
          <label class="md-nav__link" for="__nav_5_2_6" id="__nav_5_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Status
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_6">
            <span class="md-nav__icon md-icon"></span>
            Status
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../status/status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Status
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_7" >
        
          
          <label class="md-nav__link" for="__nav_5_2_7" id="__nav_5_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_7">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/data_loading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data loading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/run_args/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run args
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../dev_docs/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../dev_docs/roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../citations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cite
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Core graph grammar</h1>

<div class="doc doc-object doc-module">



<h2 id="neps.search_spaces.architecture.core_graph_grammar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">neps.search_spaces.architecture.core_graph_grammar</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CoreGraphGrammar</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar" class="headerlink" title="Permanent link">#</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">CoreGraphGrammar</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">grammars</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">terminal_to_op_names</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">terminal_to_graph_edges</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">edge_attr</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">edge_label</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">zero_op</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">identity_op</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">name</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">scope</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">return_all_subgraphs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">return_graph_per_hierarchy</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.graph.Graph" href="../graph/#neps.search_spaces.architecture.graph.Graph">Graph</a></code></p>


                  <details class="quote">
                    <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">grammars</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Grammar</span><span class="p">]</span> <span class="o">|</span> <span class="n">Grammar</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">terminal_to_op_names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">terminal_to_graph_edges</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">edge_attr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">edge_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">zero_op</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">identity_op</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">return_all_subgraphs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">return_graph_per_hierarchy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="p">):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">grammars</span> <span class="o">=</span> <span class="p">[</span><span class="n">grammars</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grammars</span><span class="p">,</span> <span class="n">Grammar</span><span class="p">)</span> <span class="k">else</span> <span class="n">grammars</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span> <span class="o">=</span> <span class="n">terminal_to_op_names</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">grammar_terminals</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">terminal</span> <span class="k">for</span> <span class="n">grammar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammars</span> <span class="k">for</span> <span class="n">terminal</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">}</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">diff_terminals</span> <span class="o">=</span> <span class="n">grammar_terminals</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff_terminals</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="sa">f</span><span class="s2">&quot;Terminals </span><span class="si">{</span><span class="n">diff_terminals</span><span class="si">}</span><span class="s2"> not defined in primitive mapping!&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">if</span> <span class="n">terminal_to_graph_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># only compute it once -&gt; more efficient</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span> <span class="o">=</span> <span class="n">get_edge_lists_of_topologies</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span> <span class="o">=</span> <span class="n">terminal_to_graph_edges</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_attr</span> <span class="o">=</span> <span class="n">edge_attr</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span> <span class="o">=</span> <span class="n">edge_label</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">zero_op</span> <span class="o">=</span> <span class="n">zero_op</span> <span class="k">if</span> <span class="n">zero_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">identity_op</span> <span class="o">=</span> <span class="n">identity_op</span> <span class="k">if</span> <span class="n">identity_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_nodes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">return_all_subgraphs</span> <span class="o">=</span> <span class="n">return_all_subgraphs</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">return_graph_per_hierarchy</span> <span class="o">=</span> <span class="n">return_graph_per_hierarchy</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.OPTIMIZER_SCOPE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">OPTIMIZER_SCOPE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.OPTIMIZER_SCOPE" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">OPTIMIZER_SCOPE</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Whether the search space has an interface to one of the tabular benchmarks which
can then be used to query architecture performances.</p>
<p>If this is set to true then <code>query()</code> should be implemented.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.__hash__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__hash__</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.__hash__" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="fm">__hash__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>As it is very complicated to compare graphs (i.e. check all edge
attributes, do the have shared attributes, ...) use just the name
for comparison.</p>
<p>This is used when determining whether two instances are copies.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    As it is very complicated to compare graphs (i.e. check all edge</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    attributes, do the have shared attributes, ...) use just the name</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    for comparison.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    This is used when determining whether two instances are copies.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">h</span> <span class="o">+=</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">h</span> <span class="o">+=</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">h</span> <span class="o">+=</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">return</span> <span class="n">h</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.add_edges_densly" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_edges_densly</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.add_edges_densly" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_edges_densly</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Adds edges to get a fully connected DAG without cycles</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="k">def</span> <span class="nf">add_edges_densly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">    Adds edges to get a fully connected DAG without cycles</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_dense_edges</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.add_node" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">add_node</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.add_node" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_node</span><span class="p">(</span><span class="n">node_index</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Adds a node to the graph.</p>
<p>Note that adding a node using an index that has been used already
will override its attributes.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>node_index</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The index for the node. Expect to be &gt;= 1.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**attr</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The attributes which can be added in a dict like form.</p>
              </div>
              <p>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>{}</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="k">def</span> <span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_index</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Adds a node to the graph.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    Note that adding a node using an index that has been used already</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    will override its attributes.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        node_index (int): The index for the node. Expect to be &gt;= 1.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        **attr: The attributes which can be added in a dict like form.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">assert</span> <span class="n">node_index</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Expecting the node index to be greater or equal 1&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_index</span><span class="p">,</span> <span class="o">**</span><span class="n">attr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.assemble_trees" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">assemble_trees</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.assemble_trees" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">assemble_trees</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">base_tree</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">motif_trees</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">terminal_to_sublanguage_map</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">node_label</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Assembles the base parse tree with the motif parse trees</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>base_tree</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Base parse tree</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="networkx.DiGraph">DiGraph</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>motif_trees</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of motif parse trees</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>List[<span title="networkx.DiGraph">DiGraph</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>node_label</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>node label key. Defaults to "op_name".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;op_name&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | <span title="networkx.DiGraph">DiGraph</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nx.DiGraph: Assembled parse tree</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="k">def</span> <span class="nf">assemble_trees</span><span class="p">(</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">base_tree</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">motif_trees</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">],</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">terminal_to_sublanguage_map</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">node_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assembles the base parse tree with the motif parse trees</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        base_tree (nx.DiGraph): Base parse tree</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        motif_trees (List[nx.DiGraph]): List of motif parse trees</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        node_label (str, optional): node label key. Defaults to &quot;op_name&quot;.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        nx.DiGraph: Assembled parse tree</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">base_tree</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">motif_trees</span><span class="p">]):</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All trees must be of the same type!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_tree</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">ensembled_tree_string</span> <span class="o">=</span> <span class="n">base_tree</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">if</span> <span class="n">terminal_to_sublanguage_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">for</span> <span class="n">motif</span><span class="p">,</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">terminal_to_sublanguage_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">motif_trees</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="p">):</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="k">if</span> <span class="n">motif</span> <span class="ow">in</span> <span class="n">ensembled_tree_string</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="n">ensembled_tree_string</span> <span class="o">=</span> <span class="n">ensembled_tree_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                    <span class="n">motif</span><span class="p">,</span> <span class="n">replacement</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                <span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="k">return</span> <span class="n">ensembled_tree_string</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_tree</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">leafnodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_leafnodes</span><span class="p">(</span><span class="n">base_tree</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">root_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_find_root</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="k">for</span> <span class="n">G</span> <span class="ow">in</span> <span class="n">motif_trees</span><span class="p">]</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">root_op_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="p">[</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="n">motif_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">root_node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                <span class="k">for</span> <span class="n">motif_tree</span><span class="p">,</span> <span class="n">root_node</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">motif_trees</span><span class="p">,</span> <span class="n">root_nodes</span><span class="p">)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="p">]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">largest_node_number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">base_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="c1"># ensembled_tree = base_tree.copy()</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="c1"># recreation is slightly faster</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">ensembled_tree</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">base_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">base_tree</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">for</span> <span class="n">leafnode</span> <span class="ow">in</span> <span class="n">leafnodes</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">base_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">leafnode</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span> <span class="o">==</span> <span class="n">root_op_names</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                <span class="k">continue</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                    <span class="s2">&quot;More than two similar terminal/start symbols are not supported!&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>                <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="n">tree</span> <span class="o">=</span> <span class="n">motif_trees</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="c1"># generate mapping</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                <span class="n">n</span><span class="p">:</span> <span class="n">n_new</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                    <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                    <span class="nb">range</span><span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                        <span class="n">largest_node_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                        <span class="n">largest_node_number</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">),</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>                    <span class="p">),</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                <span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="p">}</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="n">largest_node_number</span> <span class="o">=</span> <span class="n">largest_node_number</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="n">tree_relabeled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relabel_nodes</span><span class="p">(</span><span class="n">G</span><span class="o">=</span><span class="n">tree</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">mapping</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="c1"># compose trees</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="n">predecessor_in_base_tree</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ensembled_tree</span><span class="o">.</span><span class="n">pred</span><span class="p">[</span><span class="n">leafnode</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="n">motif_tree_root_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_root</span><span class="p">(</span><span class="n">tree_relabeled</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">successors_in_motif_tree</span> <span class="o">=</span> <span class="n">tree_relabeled</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">motif_tree_root_node</span><span class="p">][</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                <span class="s2">&quot;children&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="p">]</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="c1"># delete unnecessary edges</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">leafnode</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">tree_relabeled</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">motif_tree_root_node</span><span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="c1"># add new edges</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="n">tree_relabeled</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">predecessor_in_base_tree</span><span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">successors_in_motif_tree</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="n">tree_relabeled</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">predecessor_in_base_tree</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                <span class="n">edges</span><span class="o">=</span><span class="n">tree_relabeled</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="n">nodes</span><span class="o">=</span><span class="n">tree_relabeled</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ensembled_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor_in_base_tree</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">])</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="o">==</span> <span class="n">leafnode</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">old_children</span> <span class="o">=</span> <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor_in_base_tree</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor_in_base_tree</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="n">old_children</span><span class="p">[:</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                <span class="o">+</span> <span class="n">successors_in_motif_tree</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="o">+</span> <span class="n">old_children</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">ensembled_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor_in_base_tree</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="n">leafnode</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">return</span> <span class="n">ensembled_tree</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="sa">f</span><span class="s2">&quot;Assembling of trees of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">base_tree</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not supported!&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.build_graph_from_tree" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">build_graph_from_tree</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.build_graph_from_tree" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">tree</span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">terminal_to_torch_map</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">node_label</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">flatten_graph</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">return_cell</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.graph.Graph" href="../graph/#neps.search_spaces.architecture.graph.Graph">Graph</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Builds the computational graph from a parse tree.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>tree</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>parse tree.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="networkx.DiGraph">DiGraph</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>terminal_to_torch_map</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Mapping from terminal symbols to primitives or topologies.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>node_label</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Key to access terminal symbol. Defaults to "op_name".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;op_name&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_cell</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to return a cell. Is only needed if cell is repeated multiple times.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None | <a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.graph.Graph" href="../graph/#neps.search_spaces.architecture.graph.Graph">Graph</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tuple[Union[None, Graph]]: computational graph (self) or cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="k">def</span> <span class="nf">build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">tree</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">terminal_to_torch_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="n">node_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="n">flatten_graph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">return_cell</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Graph</span><span class="p">:</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds the computational graph from a parse tree.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        tree (nx.DiGraph): parse tree.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        terminal_to_torch_map (dict): Mapping from terminal symbols to primitives or topologies.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        node_label (str, optional): Key to access terminal symbol. Defaults to &quot;op_name&quot;.</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        return_cell (bool, optional): Whether to return a cell. Is only needed if cell is repeated multiple times.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        Defaults to False.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        Tuple[Union[None, Graph]]: computational graph (self) or cell.</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">def</span> <span class="nf">_build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">visited</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">tree</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">node</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">terminal_to_torch_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">is_primitive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="p">):</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursive DFS-esque function to build computational graph from parse tree</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            visited (set): set of visited nodes.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">            tree (nx.DiGraph): parse tree.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">            node (int): node index.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">            terminal_to_torch_map (dict): mapping from terminal symbols to primitives or topologies.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">            node_label (str): key to access operation name</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            Exception: primitive or topology is unknown, i.e., it is probably missing in the terminal to</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            torch mapping</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            Exception: leftmost children can only be primitive, topology or have one child</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            [type]: computational graph.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="n">subgraphs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="n">primitive_hps</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">out_edges</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                <span class="k">if</span> <span class="n">is_primitive</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                    <span class="k">return</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                        <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                        <span class="ow">not</span> <span class="ow">in</span> <span class="n">terminal_to_torch_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                    <span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                            <span class="sa">f</span><span class="s2">&quot;Unknown primitive or topology: </span><span class="si">{</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                        <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                    <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                        <span class="n">terminal_to_torch_map</span><span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]]</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                    <span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">out_edges</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="k">return</span> <span class="n">_build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                    <span class="n">visited</span><span class="p">,</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="n">tree</span><span class="p">,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                    <span class="n">terminal_to_torch_map</span><span class="p">,</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                    <span class="n">node_label</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="n">is_primitive</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="c1"># for idx, neighbor in enumerate(tree.neighbors(node)):</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_get_neighbors_from_parse_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="p">):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># topology or primitive</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="n">neighbor</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                    <span class="k">while</span> <span class="ow">not</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;terminal&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">out_edges</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                                <span class="s2">&quot;Leftmost Child can only be primitive, topology or recursively have one child!&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                            <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                        <span class="n">n</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                    <span class="k">if</span> <span class="n">is_primitive</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                        <span class="n">primitive_hp_key</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                        <span class="n">primitive_hp_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">primitive_hp_key</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                        <span class="n">is_primitive_op</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                            <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                            <span class="ow">not</span> <span class="ow">in</span> <span class="n">terminal_to_torch_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                        <span class="p">):</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                                <span class="sa">f</span><span class="s2">&quot;Unknown primitive or topology: </span><span class="si">{</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                            <span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                        <span class="n">graph_el</span> <span class="o">=</span> <span class="n">terminal_to_torch_map</span><span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">node_label</span><span class="p">]]</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                        <span class="n">is_primitive_op</span> <span class="o">=</span> <span class="nb">issubclass</span><span class="p">(</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                            <span class="n">graph_el</span><span class="o">.</span><span class="n">func</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph_el</span><span class="p">,</span> <span class="n">partial</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                            <span class="k">else</span> <span class="n">graph_el</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                            <span class="n">AbstractPrimitive</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                        <span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                <span class="k">elif</span> <span class="ow">not</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">neighbor</span><span class="p">][</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                    <span class="s2">&quot;terminal&quot;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                <span class="p">]:</span>  <span class="c1"># exclude &#39;[&#39; &#39;]&#39; ... symbols</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                    <span class="k">if</span> <span class="n">is_primitive</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                        <span class="n">primitive_hp_dict</span><span class="p">[</span><span class="n">primitive_hp_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                            <span class="n">visited</span><span class="p">,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                            <span class="n">tree</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                            <span class="n">neighbor</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                            <span class="n">terminal_to_torch_map</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                            <span class="n">node_label</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                            <span class="n">is_primitive_op</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                        <span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                    <span class="k">elif</span> <span class="n">is_primitive_op</span><span class="p">:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                        <span class="n">primitive_hps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                            <span class="n">_build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                                <span class="n">visited</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                                <span class="n">tree</span><span class="p">,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                                <span class="n">neighbor</span><span class="p">,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                                <span class="n">terminal_to_torch_map</span><span class="p">,</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                                <span class="n">node_label</span><span class="p">,</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                                <span class="n">is_primitive_op</span><span class="p">,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                            <span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                        <span class="p">)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                        <span class="n">subgraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                            <span class="n">_build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>                                <span class="n">visited</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                                <span class="n">tree</span><span class="p">,</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                                <span class="n">neighbor</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                                <span class="n">terminal_to_torch_map</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                                <span class="n">node_label</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                                <span class="n">is_primitive_op</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                            <span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                        <span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>                <span class="k">elif</span> <span class="p">(</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>                    <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">neighbor</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span> <span class="ow">in</span> <span class="n">terminal_to_torch_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="p">):</span>  <span class="c1"># exclude &#39;[&#39; &#39;]&#39; ... symbols</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                    <span class="c1"># TODO check if there is a potential bug here?</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                    <span class="n">subgraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>                        <span class="n">deepcopy</span><span class="p">(</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>                            <span class="n">terminal_to_torch_map</span><span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">neighbor</span><span class="p">][</span><span class="n">node_label</span><span class="p">]]</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                        <span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                    <span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="k">if</span> <span class="n">is_primitive</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="k">return</span> <span class="n">primitive_hp_dict</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="k">elif</span> <span class="n">is_primitive_op</span><span class="p">:</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                    <span class="n">collections</span><span class="o">.</span><span class="n">ChainMap</span><span class="p">(</span><span class="o">*</span><span class="p">([{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="n">graph_el</span><span class="p">}]</span> <span class="o">+</span> <span class="n">primitive_hps</span><span class="p">))</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="p">)</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="k">return</span> <span class="n">graph_el</span><span class="p">(</span><span class="o">*</span><span class="n">subgraphs</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="k">def</span> <span class="nf">_flatten_graph</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="n">graph</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="n">flattened_graph</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="n">start_node</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="n">end_node</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="p">):</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="n">nodes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="n">_u</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="n">_u</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                    <span class="mi">1</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flattened_graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                    <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="n">flattened_graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                <span class="n">_u</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                    <span class="n">start_node</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                    <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">start_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                    <span class="k">else</span> <span class="n">_u</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="n">nodes</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">_u</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="k">if</span> <span class="n">_u</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">flattened_graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                    <span class="n">flattened_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">_u</span><span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                <span class="n">_v</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="n">_v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">flattened_graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                <span class="n">_v</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                    <span class="n">end_node</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                    <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">end_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>                    <span class="k">else</span> <span class="n">_v</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="p">)</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                <span class="n">nodes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                <span class="k">if</span> <span class="n">_v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">flattened_graph</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>                    <span class="n">flattened_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">_v</span><span class="p">)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">],</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                <span class="n">flattened_graph</span> <span class="o">=</span> <span class="n">_flatten_graph</span><span class="p">(</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;op&quot;</span><span class="p">],</span> <span class="n">flattened_graph</span><span class="p">,</span> <span class="n">start_node</span><span class="o">=</span><span class="n">_u</span><span class="p">,</span> <span class="n">end_node</span><span class="o">=</span><span class="n">_v</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="n">flattened_graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">_u</span><span class="p">,</span> <span class="n">_v</span><span class="p">)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                <span class="n">flattened_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">_u</span><span class="p">,</span> <span class="n">_v</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="k">return</span> <span class="n">flattened_graph</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="n">root_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_root</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="n">graph</span> <span class="o">=</span> <span class="n">_build_graph_from_tree</span><span class="p">(</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="nb">set</span><span class="p">(),</span> <span class="n">tree</span><span class="p">,</span> <span class="n">root_node</span><span class="p">,</span> <span class="n">terminal_to_torch_map</span><span class="p">,</span> <span class="n">node_label</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="p">)</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_check_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="k">if</span> <span class="n">return_cell</span><span class="p">:</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">cell</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">_flatten_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">flattened_graph</span><span class="o">=</span><span class="n">Graph</span><span class="p">())</span> <span class="k">if</span> <span class="n">flatten_graph</span> <span class="k">else</span> <span class="n">graph</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="p">)</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="k">return</span> <span class="n">cell</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="k">if</span> <span class="n">flatten_graph</span><span class="p">:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>            <span class="n">_flatten_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">flattened_graph</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.clone" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">clone</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.clone" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clone</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Deep copy of the current graph.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Graph</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Deep copy of the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    Deep copy of the current graph.</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        Graph: Deep copy of the graph.</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.compile" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compile</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.compile" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">compile</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Instanciates the ops at the edges using the arguments specified at the edges</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">    Instanciates the ops at the edges using the arguments specified at the edges</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>    <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">]:</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compiling graph </span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edge_data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">is_final</span><span class="p">():</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="n">op</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">)</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                    <span class="n">compiled_ops</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">op</span><span class="p">):</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>                        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>                            <span class="c1"># get the relevant parameter if there are more.</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                            <span class="n">a</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>                                <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>                            <span class="p">}</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>                            <span class="n">compiled_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">(</span><span class="o">**</span><span class="n">a</span><span class="p">))</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;op </span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="s2"> already compiled. Skipping&quot;</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                    <span class="n">edge_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="n">compiled_ops</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">AbstractPrimitive</span><span class="p">):</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;op </span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2"> already compiled. Skipping&quot;</span><span class="p">)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">AbstractPrimitive</span><span class="p">):</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>                    <span class="c1"># Init the class</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>                    <span class="k">if</span> <span class="s2">&quot;op_name&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>                        <span class="k">del</span> <span class="n">attr</span><span class="p">[</span><span class="s2">&quot;op_name&quot;</span><span class="p">]</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>                    <span class="n">edge_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="n">op</span><span class="p">(</span><span class="o">**</span><span class="n">attr</span><span class="p">))</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>                    <span class="k">pass</span>  <span class="c1"># This is already covered by _get_child_graphs</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unkown format of op: </span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.copy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">copy</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.copy" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">copy</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Copy as defined in networkx, i.e. a shallow copy.</p>
<p>Just handling recursively nested graphs seperately.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    Copy as defined in networkx, i.e. a shallow copy.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Just handling recursively nested graphs seperately.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">def</span> <span class="nf">copy_dict</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="n">copied_dict</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>                <span class="n">copied_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                <span class="n">copied_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                    <span class="n">i</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Graph</span><span class="p">)</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="p">]</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">AbstractPrimitive</span><span class="p">):</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="n">copied_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="k">return</span> <span class="n">copied_dict</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">copy_dict</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">datadict</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">nbrs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adj</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">datadict</span> <span class="ow">in</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">G</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">G</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.forward" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.forward" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Forward some data through the graph. This is done recursively
in case there are graphs defined on nodes or as 'op' on edges.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>x</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input. If the graph sits on a node the
input can be a dict with {source_idx: Tensor} to be routed
to the defined input nodes. If the graph sits on an edge,
x is the feature tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>Tensor or <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>args</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>This is only required to handle cases where the graph sits
on an edge and receives an EdgeData object which will be ignored</p>
              </div>
              <p>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>()</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    Forward some data through the graph. This is done recursively</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    in case there are graphs defined on nodes or as &#39;op&#39; on edges.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        x (Tensor or dict): The input. If the graph sits on a node the</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            input can be a dict with {source_idx: Tensor} to be routed</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            to the defined input nodes. If the graph sits on an edge,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            x is the feature tensor.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        args: This is only required to handle cases where the graph sits</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            on an edge and receives an EdgeData object which will be ignored</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graph </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> called. Input </span><span class="si">{</span><span class="n">log_formats</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="c1"># Assign x to the corresponding input nodes</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_x_to_nodes</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">for</span> <span class="n">node_idx</span> <span class="ow">in</span> <span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="s2">&quot;Node </span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">, current data </span><span class="si">{}</span><span class="s2">, start processing...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">log_formats</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>            <span class="p">)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="c1"># node internal: process input if necessary</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;subgraph&quot;</span> <span class="ow">in</span> <span class="n">node</span> <span class="ow">and</span> <span class="s2">&quot;comb_op&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="s2">&quot;comb_op&quot;</span> <span class="ow">in</span> <span class="n">node</span> <span class="ow">and</span> <span class="s2">&quot;subgraph&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="p">):</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">log_first_n</span><span class="p">(</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">,</span> <span class="s2">&quot;Comb_op is ignored if subgraph is defined!&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="c1"># TODO: merge &#39;subgraph&#39; and &#39;comb_op&#39;. It is basicallly the same thing. Also in parse()</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">if</span> <span class="s2">&quot;subgraph&quot;</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;subgraph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">])</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;comb_op&quot;</span><span class="p">](</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                    <span class="p">[</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                <span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="n">node</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># clear the input as we have processed it</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node_idx</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="ow">and</span> <span class="n">node_idx</span> <span class="o">&lt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="p">):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="c1"># We have more than one output node. This is e.g. the case for</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="c1"># auxillary losses. Attach them to the graph, handling must done</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="c1"># by the user.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="s2">&quot;Graph </span><span class="si">{}</span><span class="s2"> has more then one output node. Storing output of non-maximum index node </span><span class="si">{}</span><span class="s2"> at graph dict&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                    <span class="bp">self</span><span class="p">,</span> <span class="n">node_idx</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                <span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;out_from_</span><span class="si">{</span><span class="n">node_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="c1"># outgoing edges: process all outgoing edges</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="k">for</span> <span class="n">neigbor_idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node_idx</span><span class="p">):</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="n">edge_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">node_idx</span><span class="p">,</span> <span class="n">neigbor_idx</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                <span class="c1"># inject edge data only for AbstractPrimitive, not Graphs</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                    <span class="n">edge_output</span> <span class="o">=</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="n">AbstractPrimitive</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                        <span class="s2">&quot;Processing op </span><span class="si">{}</span><span class="s2"> at edge </span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                            <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">neigbor_idx</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                        <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                    <span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>                    <span class="n">edge_output</span> <span class="o">=</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                        <span class="s2">&quot;Unknown class as op: </span><span class="si">{}</span><span class="s2">. Expected either Graph or AbstactPrimitive&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                            <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                        <span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                    <span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">neigbor_idx</span><span class="p">][</span><span class="s2">&quot;input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">node_idx</span><span class="p">:</span> <span class="n">edge_output</span><span class="p">})</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">node_idx</span><span class="si">}</span><span class="s2">, processing done.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graph </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> exiting. Output </span><span class="si">{</span><span class="n">log_formats</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_nxTree_to_stringTree" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_nxTree_to_stringTree</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_nxTree_to_stringTree" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_nxTree_to_stringTree</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">nxTree</span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span> <span class="n">node_label</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Transforms parse tree represented as NetworkX DAG to string representation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>nxTree</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>parse tree.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="networkx.DiGraph">DiGraph</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>node_label</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>key to access operation names. Defaults to "op_name".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;op_name&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>str</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>parse tree represented as string.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="k">def</span> <span class="nf">from_nxTree_to_stringTree</span><span class="p">(</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">nxTree</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">node_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms parse tree represented as NetworkX DAG to string representation.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">        nxTree (nx.DiGraph): parse tree.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">        node_label (str, optional): key to access operation names. Defaults to &quot;op_name&quot;.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">        str: parse tree represented as string.</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">visited</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>            <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;terminal&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="n">tmp_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>            <span class="c1"># for neighbor in graph.neighbors(node):</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_neighbors_from_parse_tree</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                <span class="n">tmp_str</span> <span class="o">+=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">visited</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="n">tmp_str</span> <span class="o">=</span> <span class="n">tmp_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="k">return</span> <span class="n">tmp_str</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>    <span class="k">return</span> <span class="n">dfs</span><span class="p">(</span><span class="nb">set</span><span class="p">(),</span> <span class="n">nxTree</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_find_root</span><span class="p">(</span><span class="n">nxTree</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_stringTree_to_graph_repr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_stringTree_to_graph_repr</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_stringTree_to_graph_repr" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_stringTree_to_graph_repr</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">string_tree</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">grammar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">valid_terminals</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="collections.abc.KeysView" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.KeysView">KeysView</a></span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">edge_attr</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">sym_name</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">prune</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">add_subtree_map</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">return_all_subgraphs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">return_graph_per_hierarchy</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="collections.OrderedDict" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict">OrderedDict</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Generates graph from parse tree in string representation.
Note that we ignore primitive HPs!</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>string_tree</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>parse tree.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>grammar</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>underlying grammar.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>valid_terminals</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>list of keys.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>edge_attr</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shoud graph be edge attributed (True) or node attributed (False). Defaults to True.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sym_name</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Attribute name of operation. Defaults to "op_name".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;op_name&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>prune</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Prune graph, e.g., None operations etc. Defaults to True.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>add_subtree_map</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Add attribute indicating to which subtrees of
the parse tree the specific part belongs to. Can only be true if you set prune=False!
TODO: Check if we really need this constraint or can also allow pruning. Defaults to False.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_all_subgraphs</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additionally returns an hierarchical dictionary
containing all subgraphs. Defaults to False.
TODO: check if edge attr also works.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_graph_per_hierarchy</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additionally returns a graph from each
each hierarchy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="networkx.DiGraph">DiGraph</span> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<span title="networkx.DiGraph">DiGraph</span>, <a class="autorefs autorefs-external" title="collections.OrderedDict" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict">OrderedDict</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nx.DiGraph: [description]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="k">def</span> <span class="nf">from_stringTree_to_graph_repr</span><span class="p">(</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="n">string_tree</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="n">valid_terminals</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">KeysView</span><span class="p">,</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="n">edge_attr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="n">sym_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="n">prune</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="n">add_subtree_map</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="n">return_all_subgraphs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="n">return_graph_per_hierarchy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">]:</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates graph from parse tree in string representation.</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">    Note that we ignore primitive HPs!</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        string_tree (str): parse tree.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        grammar (Grammar): underlying grammar.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        valid_terminals (list): list of keys.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        edge_attr (bool, optional): Shoud graph be edge attributed (True) or node attributed (False). Defaults to True.</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        sym_name (str, optional): Attribute name of operation. Defaults to &quot;op_name&quot;.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">        prune (bool, optional): Prune graph, e.g., None operations etc. Defaults to True.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        add_subtree_map (bool, optional): Add attribute indicating to which subtrees of</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">            the parse tree the specific part belongs to. Can only be true if you set prune=False!</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">            TODO: Check if we really need this constraint or can also allow pruning. Defaults to False.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">        return_all_subgraphs (bool, optional): Additionally returns an hierarchical dictionary</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">            containing all subgraphs. Defaults to False.</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">            TODO: check if edge attr also works.</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        return_graph_per_hierarchy (bool, optional): Additionally returns a graph from each</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">            each hierarchy.</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">        nx.DiGraph: [description]</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>    <span class="k">def</span> <span class="nf">get_node_labels</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>            <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">sym_name</span><span class="p">])</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;input&quot;</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;output&quot;</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="p">]</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>    <span class="k">def</span> <span class="nf">get_hierarchicy_dict</span><span class="p">(</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>        <span class="n">string_tree</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">subgraphs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>        <span class="n">hierarchy_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="n">hierarchy_level_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="p">):</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="k">if</span> <span class="n">hierarchy_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>            <span class="n">hierarchy_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="k">if</span> <span class="n">hierarchy_level_counter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hierarchy_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="n">hierarchy_dict</span><span class="p">[</span><span class="n">hierarchy_level_counter</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="n">hierarchy_dict</span><span class="p">[</span><span class="n">hierarchy_level_counter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string_tree</span><span class="p">)</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="n">node_labels</span> <span class="o">=</span> <span class="n">get_node_labels</span><span class="p">(</span><span class="n">subgraphs</span><span class="p">[</span><span class="n">string_tree</span><span class="p">])</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">node_label</span> <span class="ow">in</span> <span class="n">node_labels</span><span class="p">:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>            <span class="k">if</span> <span class="n">node_label</span> <span class="ow">in</span> <span class="n">subgraphs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>                <span class="n">hierarchy_dict</span> <span class="o">=</span> <span class="n">get_hierarchicy_dict</span><span class="p">(</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>                    <span class="n">node_label</span><span class="p">,</span> <span class="n">subgraphs</span><span class="p">,</span> <span class="n">hierarchy_dict</span><span class="p">,</span> <span class="n">hierarchy_level_counter</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>                <span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>        <span class="k">return</span> <span class="n">hierarchy_dict</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="k">def</span> <span class="nf">get_graph_per_hierarchy</span><span class="p">(</span><span class="n">string_tree</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subgraphs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="n">hierarchy_dict</span> <span class="o">=</span> <span class="n">get_hierarchicy_dict</span><span class="p">(</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>            <span class="n">string_tree</span><span class="o">=</span><span class="n">string_tree</span><span class="p">,</span> <span class="n">subgraphs</span><span class="o">=</span><span class="n">subgraphs</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="p">)</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="n">graph_per_hierarchy</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hierarchy_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>                <span class="n">graph_per_hierarchy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">subgraphs</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                <span class="n">subgraph_</span> <span class="o">=</span> <span class="n">graph_per_hierarchy</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                <span class="n">node_labels</span> <span class="o">=</span> <span class="n">get_node_labels</span><span class="p">(</span><span class="n">subgraph_</span><span class="p">)</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>                <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">node_label</span> <span class="ow">in</span> <span class="n">node_labels</span><span class="p">:</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>                    <span class="k">if</span> <span class="n">node_label</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">subgraphs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                        <span class="n">in_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">subgraph_</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>                        <span class="n">out_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">subgraph_</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                        <span class="n">node_offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">subgraph_</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                        <span class="n">new_subgraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>                            <span class="n">subgraphs</span><span class="p">[</span><span class="n">node_label</span><span class="p">],</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                            <span class="n">mapping</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                                <span class="n">n</span><span class="p">:</span> <span class="n">n</span> <span class="o">+</span> <span class="n">node_offset</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">subgraphs</span><span class="p">[</span><span class="n">node_label</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                            <span class="p">},</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                            <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                        <span class="p">)</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                        <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">new_subgraph</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                        <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">new_subgraph</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                        <span class="p">(</span><span class="n">begin_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                        <span class="p">(</span><span class="n">end_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>                        <span class="n">successors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_subgraph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">begin_node</span><span class="p">))</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>                        <span class="n">predecessors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_subgraph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">end_node</span><span class="p">))</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>                        <span class="n">new_subgraph</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">([</span><span class="n">begin_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">])</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>                        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>                        <span class="n">added_identities</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>                        <span class="k">for</span> <span class="n">in_node</span> <span class="ow">in</span> <span class="n">in_nodes</span><span class="p">:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>                            <span class="k">for</span> <span class="n">succ</span> <span class="ow">in</span> <span class="n">successors</span><span class="p">:</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>                                <span class="k">if</span> <span class="n">succ</span> <span class="o">==</span> <span class="n">end_node</span><span class="p">:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">added_identities</span><span class="p">:</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>                                        <span class="n">edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>                                            <span class="p">[</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>                                                <span class="p">(</span><span class="n">inn</span><span class="p">,</span> <span class="n">onn</span><span class="p">)</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>                                                <span class="k">for</span> <span class="n">inn</span> <span class="ow">in</span> <span class="n">in_nodes</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>                                                <span class="k">for</span> <span class="n">onn</span> <span class="ow">in</span> <span class="n">out_nodes</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>                                            <span class="p">]</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                                    <span class="n">added_identities</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>                                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">in_node</span><span class="p">,</span> <span class="n">succ</span><span class="p">))</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>                        <span class="k">for</span> <span class="n">out_node</span> <span class="ow">in</span> <span class="n">out_nodes</span><span class="p">:</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>                            <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">predecessors</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>                                <span class="k">if</span> <span class="n">pred</span> <span class="o">!=</span> <span class="n">begin_node</span><span class="p">:</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>                                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pred</span><span class="p">,</span> <span class="n">out_node</span><span class="p">))</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>                        <span class="n">subgraph_</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">new_subgraph</span><span class="p">,</span> <span class="n">subgraph_</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>                        <span class="n">subgraph_</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>                        <span class="n">subgraph_</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>                <span class="n">graph_per_hierarchy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">subgraph_</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="k">return</span> <span class="n">graph_per_hierarchy</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="k">def</span> <span class="nf">to_node_attributed_edge_list</span><span class="p">(</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>        <span class="n">edge_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="n">node_offset</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>        <span class="n">edge_to_node_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">node_offset</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">edge_list</span><span class="p">)}</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">}</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">}</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="p">(</span><span class="n">src</span><span class="p">,)</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="p">(</span><span class="n">tgt</span><span class="p">,)</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">:</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>            <span class="n">ni</span> <span class="o">=</span> <span class="n">edge_to_node_map</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="n">src</span><span class="p">:</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>                <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">ni</span><span class="p">))</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>            <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">tgt</span><span class="p">:</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>                <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ni</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>            <span class="k">for</span> <span class="n">e_</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>                <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">),</span> <span class="n">edge_list</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>            <span class="p">):</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>                <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">edge_to_node_map</span><span class="p">[</span><span class="n">e_</span><span class="p">],</span> <span class="n">ni</span><span class="p">))</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>        <span class="k">return</span> <span class="n">node_list</span><span class="p">,</span> <span class="n">edge_to_node_map</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="k">def</span> <span class="nf">skip_char</span><span class="p">(</span><span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="n">add_subtree_map</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>    <span class="k">if</span> <span class="n">return_all_subgraphs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="n">return_all_subgraphs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_subgraphs</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>    <span class="k">if</span> <span class="n">return_graph_per_hierarchy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="n">return_graph_per_hierarchy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_graph_per_hierarchy</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>    <span class="n">compute_subgraphs</span> <span class="o">=</span> <span class="n">return_all_subgraphs</span> <span class="ow">or</span> <span class="n">return_graph_per_hierarchy</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>    <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>        <span class="n">q_nonterminals</span><span class="p">:</span> <span class="n">Deque</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">()</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="n">q_subtrees</span><span class="p">:</span> <span class="n">Deque</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">()</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="n">q_subgraphs</span><span class="p">:</span> <span class="n">Deque</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">()</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="n">subgraphs_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>    <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>        <span class="n">node_offset</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="n">q_el</span><span class="p">:</span> <span class="n">Deque</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">()</span>  <span class="c1"># edge-attr</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="n">terminal_to_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attributed</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">sym_name</span><span class="p">:</span> <span class="s2">&quot;input&quot;</span><span class="p">})</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">sym_name</span><span class="p">:</span> <span class="s2">&quot;output&quot;</span><span class="p">})</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="n">node_offset</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_nodes</span><span class="p">):</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>            <span class="n">terminal_to_graph_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_nodes</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="n">terminal_to_graph_nodes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>                <span class="n">k</span><span class="p">:</span> <span class="n">to_node_attributed_edge_list</span><span class="p">(</span><span class="n">edge_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">edge_list</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">edge_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="p">}</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_nodes</span> <span class="o">=</span> <span class="n">terminal_to_graph_nodes</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="n">terminal_to_graph</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">v</span> <span class="k">else</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terminal_to_graph_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="p">}</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="n">q_el</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">()</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>    <span class="c1"># pre-compute stuff</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="n">begin_end_nodes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>    <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">terminal_to_graph</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="k">if</span> <span class="n">g</span><span class="p">:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="p">}</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="p">}</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="p">(</span><span class="n">begin_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>            <span class="p">(</span><span class="n">end_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="n">begin_end_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">begin_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">)</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>            <span class="n">begin_end_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>    <span class="k">for</span> <span class="n">split_idx</span><span class="p">,</span> <span class="n">sym</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">string_tree</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)):</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="n">is_nonterminal</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="k">if</span> <span class="n">sym</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>            <span class="k">continue</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>        <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>            <span class="n">new_sym</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>            <span class="n">sym_copy</span> <span class="o">=</span> <span class="n">sym</span><span class="p">[:]</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="k">if</span> <span class="n">sym</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="n">sym</span> <span class="o">=</span> <span class="n">sym</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>            <span class="n">is_nonterminal</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="k">if</span> <span class="n">sym</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>            <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>                    <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>                <span class="n">new_sym</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>            <span class="k">while</span> <span class="n">sym</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span> <span class="ow">and</span> <span class="n">sym</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_terminals</span><span class="p">:</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>                <span class="n">sym</span> <span class="o">=</span> <span class="n">sym</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="k">if</span> <span class="n">compute_subgraphs</span> <span class="ow">and</span> <span class="n">new_sym</span><span class="p">:</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>            <span class="k">if</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>                <span class="c1"># need dict as a graph can have multiple subgraphs</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>                <span class="n">q_subtrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym_copy</span><span class="p">[:])</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>                <span class="n">q_subtrees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">sym_copy</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">skip_char</span><span class="p">(</span><span class="n">sym</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="k">continue</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="k">if</span> <span class="n">add_subtree_map</span> <span class="ow">and</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>            <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sym</span><span class="p">,</span> <span class="n">split_idx</span><span class="p">))</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="k">elif</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">valid_terminals</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_nonterminal</span><span class="p">:</span>  <span class="c1"># terminal symbol</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="k">if</span> <span class="n">sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="p">:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_el</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>                    <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>                        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>                            <span class="nb">tuple</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">node_offset</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>                        <span class="p">]</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>                        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>                            <span class="nb">tuple</span><span class="p">(</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">terminal_to_graph_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>                        <span class="p">]</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>                        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>                            <span class="n">terminal_to_graph_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">e</span><span class="p">]</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>                        <span class="p">]</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>                    <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>                        <span class="n">subtrees</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>                    <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>                    <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>                    <span class="p">(</span><span class="n">src_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>                    <span class="p">(</span><span class="n">sink_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>                    <span class="n">begin_node</span><span class="p">,</span> <span class="n">end_node</span> <span class="o">=</span> <span class="n">begin_end_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>                    <span class="n">el</span> <span class="o">=</span> <span class="n">q_el</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>                    <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>                        <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">el</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>                        <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>                            <span class="n">subtrees</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;subtrees&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>                        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>                            <span class="nb">tuple</span><span class="p">(</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>                                <span class="n">u</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>                                <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">begin_node</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>                                <span class="k">else</span> <span class="n">v</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>                                <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">end_node</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>                                <span class="k">else</span> <span class="n">t</span> <span class="o">+</span> <span class="n">node_offset</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>                                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">e</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>                        <span class="p">]</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>                        <span class="n">n</span> <span class="o">=</span> <span class="n">el</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>                        <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>                            <span class="n">subtrees</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;subtrees&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>                        <span class="n">in_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>                        <span class="n">out_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>                        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>                        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">terminal_to_graph_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">begin_node</span> <span class="ow">or</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_node</span><span class="p">):</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>                                <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">node_offset</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">node_offset</span><span class="p">))</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>                            <span class="k">elif</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">begin_node</span><span class="p">:</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>                                <span class="k">for</span> <span class="n">nin</span> <span class="ow">in</span> <span class="n">in_nodes</span><span class="p">:</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>                                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nin</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">node_offset</span><span class="p">))</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>                            <span class="k">elif</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_node</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>                                <span class="k">for</span> <span class="n">nout</span> <span class="ow">in</span> <span class="n">out_nodes</span><span class="p">:</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>                                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">node_offset</span><span class="p">,</span> <span class="n">nout</span><span class="p">))</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>                        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>                            <span class="n">terminal_to_graph_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">e</span><span class="p">]</span> <span class="o">+</span> <span class="n">node_offset</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>                        <span class="p">]</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>                <span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>                <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>                    <span class="n">subgraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>                    <span class="n">subgraph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>                    <span class="n">q_subgraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>                        <span class="p">{</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>                            <span class="s2">&quot;graph&quot;</span><span class="p">:</span> <span class="n">subgraph</span><span class="p">,</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>                            <span class="s2">&quot;atoms&quot;</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>                                <span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>                                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="p">(</span><span class="n">edges</span> <span class="k">if</span> <span class="n">edge_attr</span> <span class="k">else</span> <span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>                            <span class="p">),</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>                        <span class="p">}</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>                <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>                    <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>                        <span class="n">subtrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_nonterminals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>                        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>                            <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;subtrees&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtrees</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>                        <span class="n">subtrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_nonterminals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>                        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>                            <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;subtrees&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtrees</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>                <span class="n">q_el</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">edges</span> <span class="k">if</span> <span class="n">edge_attr</span> <span class="k">else</span> <span class="n">nodes</span><span class="p">))</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>                <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>                    <span class="n">node_offset</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="p">[</span><span class="n">sym</span><span class="p">]))</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>                    <span class="n">node_offset</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span><span class="n">terminal_to_graph_nodes</span><span class="p">[</span><span class="n">sym</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># primitive operations</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>                <span class="n">el</span> <span class="o">=</span> <span class="n">q_el</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>                <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>                    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">el</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>                    <span class="k">if</span> <span class="n">prune</span> <span class="ow">and</span> <span class="n">sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_op</span><span class="p">:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>                        <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>                            <span class="k">del</span> <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">][(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)]</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>                        <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                        <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">][</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>                        <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>                            <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s2">&quot;subtrees&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_nonterminals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>                            <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>                <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="n">el</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                    <span class="k">if</span> <span class="n">prune</span> <span class="ow">and</span> <span class="n">sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_op</span><span class="p">:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                        <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>                            <span class="k">del</span> <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>                    <span class="k">elif</span> <span class="n">prune</span> <span class="ow">and</span> <span class="n">sym</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_op</span><span class="p">:</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>                            <span class="p">[</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>                                <span class="p">(</span><span class="n">n_in</span><span class="p">,</span> <span class="n">n_out</span><span class="p">)</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>                                <span class="k">for</span> <span class="n">n_in</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>                                <span class="k">for</span> <span class="n">n_out</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>                            <span class="p">]</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>                        <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>                                <span class="p">[</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>                                    <span class="p">(</span><span class="n">n_in</span><span class="p">,</span> <span class="n">n_out</span><span class="p">)</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>                                    <span class="k">for</span> <span class="n">n_in</span> <span class="ow">in</span> <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>                                        <span class="n">n</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>                                    <span class="p">)</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>                                    <span class="k">for</span> <span class="n">n_out</span> <span class="ow">in</span> <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>                                        <span class="n">n</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>                                    <span class="p">)</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>                                <span class="p">]</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>                            <span class="k">del</span> <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>                        <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>                        <span class="k">if</span> <span class="n">compute_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>                            <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">][</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>                                <span class="nb">next</span><span class="p">(</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>                                    <span class="nb">filter</span><span class="p">(</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>                                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>                                        <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>                                    <span class="p">)</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>                                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>                            <span class="p">]</span> <span class="o">=</span> <span class="n">sym</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>                        <span class="k">if</span> <span class="n">add_subtree_map</span><span class="p">:</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>                            <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;subtrees&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_nonterminals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>                            <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>        <span class="k">if</span> <span class="n">compute_subgraphs</span> <span class="ow">and</span> <span class="n">sym_copy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>            <span class="n">q_subtrees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">sym_copy</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sym_copy</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>                <span class="n">subtree_identifier</span> <span class="o">=</span> <span class="n">q_subtrees</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_subtrees</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>                    <span class="n">q_subtrees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">subtree_identifier</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_subtrees</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_subgraphs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>                    <span class="n">difference</span> <span class="o">=</span> <span class="n">subtree_identifier</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>                        <span class="s2">&quot;(&quot;</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>                    <span class="p">)</span> <span class="o">-</span> <span class="n">subtree_identifier</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>                    <span class="k">if</span> <span class="n">difference</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>                        <span class="n">subtree_identifier</span> <span class="o">=</span> <span class="n">subtree_identifier</span><span class="p">[:</span><span class="n">difference</span><span class="p">]</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>                    <span class="n">subgraph_dict</span> <span class="o">=</span> <span class="n">q_subgraphs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>                    <span class="n">subgraph</span> <span class="o">=</span> <span class="n">subgraph_dict</span><span class="p">[</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>                    <span class="n">atoms</span> <span class="o">=</span> <span class="n">subgraph_dict</span><span class="p">[</span><span class="s2">&quot;atoms&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_subtrees</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>                        <span class="c1"># subtree_identifier is subgraph graph at [-1]</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>                        <span class="c1"># (and sub-...-subgraph currently in q_subgraphs)</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>                        <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">][</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>                            <span class="nb">next</span><span class="p">(</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>                                <span class="nb">filter</span><span class="p">(</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>                                    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>                                    <span class="n">q_subgraphs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;atoms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>                                <span class="p">)</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>                            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>                        <span class="p">]</span> <span class="o">=</span> <span class="n">subtree_identifier</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>                    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atoms</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>                        <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>                            <span class="n">subgraph</span><span class="p">[</span><span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]][</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>                            <span class="n">subgraph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">sym_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">edge_attr</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>                        <span class="c1"># ensure there is actually one input and output node</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>                        <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">subgraph</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>                        <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">subgraph</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>                        <span class="n">new_src_node</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">subgraph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>                        <span class="n">src_nodes</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>                        <span class="n">subgraph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>                            <span class="p">[</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>                                <span class="p">(</span><span class="n">new_src_node</span><span class="p">,</span> <span class="n">successor</span><span class="p">)</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>                                <span class="k">for</span> <span class="n">src_node</span> <span class="ow">in</span> <span class="n">src_nodes</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>                                <span class="k">for</span> <span class="n">successor</span> <span class="ow">in</span> <span class="n">subgraph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">src_node</span><span class="p">)</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>                            <span class="p">]</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                        <span class="n">subgraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">new_src_node</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">sym_name</span><span class="p">:</span> <span class="s2">&quot;input&quot;</span><span class="p">})</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                        <span class="n">subgraph</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="n">src_nodes</span><span class="p">)</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>                        <span class="n">new_sink_node</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">subgraph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>                        <span class="n">sink_nodes</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>                        <span class="n">subgraph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>                            <span class="p">[</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>                                <span class="p">(</span><span class="n">predecessor</span><span class="p">,</span> <span class="n">new_sink_node</span><span class="p">)</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>                                <span class="k">for</span> <span class="n">sink_node</span> <span class="ow">in</span> <span class="n">sink_nodes</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>                                <span class="k">for</span> <span class="n">predecessor</span> <span class="ow">in</span> <span class="n">subgraph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">sink_node</span><span class="p">)</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>                            <span class="p">]</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>                        <span class="n">subgraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">new_sink_node</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">sym_name</span><span class="p">:</span> <span class="s2">&quot;output&quot;</span><span class="p">})</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>                        <span class="n">subgraph</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="n">sink_nodes</span><span class="p">)</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>                    <span class="n">subgraphs_dict</span><span class="p">[</span><span class="n">subtree_identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">subgraph</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_el</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid string_tree&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>    <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prune_unconnected_parts</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">src_node</span><span class="p">,</span> <span class="n">sink_node</span><span class="p">)</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_check_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>    <span class="k">if</span> <span class="n">return_all_subgraphs</span> <span class="ow">or</span> <span class="n">return_graph_per_hierarchy</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="n">return_val</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="p">]</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>        <span class="n">subgraphs_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="nb">reversed</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">subgraphs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>        <span class="p">)</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>        <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">subgraphs_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>                <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>                <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">edges</span><span class="p">}</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>                <span class="p">(</span><span class="n">vG_src_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>                <span class="p">(</span><span class="n">vG_sink_node</span><span class="p">,)</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prune_unconnected_parts</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vG_src_node</span><span class="p">,</span> <span class="n">vG_sink_node</span><span class="p">)</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_check_graph</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>        <span class="k">if</span> <span class="n">return_all_subgraphs</span><span class="p">:</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>            <span class="n">return_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subgraphs_dict</span><span class="p">)</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>        <span class="k">if</span> <span class="n">return_graph_per_hierarchy</span><span class="p">:</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="n">graph_per_hierarchy</span> <span class="o">=</span> <span class="n">get_graph_per_hierarchy</span><span class="p">(</span><span class="n">string_tree</span><span class="p">,</span> <span class="n">subgraphs_dict</span><span class="p">)</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>            <span class="n">_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>                <span class="n">graph_per_hierarchy</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>            <span class="p">)</span>  <span class="c1"># remove last graph since it is equal to full graph</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>            <span class="n">return_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph_per_hierarchy</span><span class="p">)</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>        <span class="k">return</span> <span class="n">return_val</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_stringTree_to_nxTree" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_stringTree_to_nxTree</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.from_stringTree_to_nxTree" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_stringTree_to_nxTree</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">string_tree</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">grammar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">sym_name</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Transforms a parse tree from string representation to NetworkX representation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>string_tree</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>parse tree.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>grammar</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>context-free grammar which generated the parse tree in string represenation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sym_name</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Key to save the terminal symbols. Defaults to "op_name".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;op_name&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="networkx.DiGraph">DiGraph</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nx.DiGraph: parse tree as NetworkX representation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="k">def</span> <span class="nf">from_stringTree_to_nxTree</span><span class="p">(</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="n">string_tree</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span> <span class="n">sym_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms a parse tree from string representation to NetworkX representation.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        string_tree (str): parse tree.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        grammar (Grammar): context-free grammar which generated the parse tree in string represenation.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        sym_name (str, optional): Key to save the terminal symbols. Defaults to &quot;op_name&quot;.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        nx.DiGraph: parse tree as NetworkX representation.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>    <span class="k">def</span> <span class="nf">skip_char</span><span class="p">(</span><span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="c1"># special case: &quot;(&quot; is (part of) a terminal</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="ow">and</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="ow">and</span> <span class="n">string_tree</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>            <span class="ow">and</span> <span class="n">string_tree</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="p">):</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="k">def</span> <span class="nf">find_longest_match</span><span class="p">(</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">string_tree</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">max_match</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="c1"># search for longest matching symbol and add it</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="c1"># assumes that the longest match is the true match</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">j</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">max_match</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">string_tree</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="k">while</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">string_tree</span><span class="p">):</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">if</span> <span class="n">string_tree</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="k">break</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Terminal or nonterminal at position </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">return</span> <span class="n">j</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="n">full_grammar</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">grammar</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="n">rules</span> <span class="o">=</span> <span class="n">full_grammar</span><span class="o">.</span><span class="n">productions</span><span class="p">()</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">nonterminals</span> <span class="o">=</span> <span class="n">full_grammar</span><span class="o">.</span><span class="n">nonterminals</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="n">terminals</span> <span class="o">=</span> <span class="n">full_grammar</span><span class="o">.</span><span class="n">terminals</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">grammar</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">rules</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">productions</span><span class="p">())</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>            <span class="n">nonterminals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">)</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="n">terminals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">terminals</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">grammar</span> <span class="o">=</span> <span class="n">full_grammar</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;TODO check implementation&quot;</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="n">symbols</span> <span class="o">=</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span> <span class="o">+</span> <span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>    <span class="n">max_match</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">symbols</span><span class="p">))</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>    <span class="n">find_longest_match_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="n">find_longest_match</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="n">string_tree</span><span class="o">=</span><span class="n">string_tree</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">,</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="n">max_match</span><span class="o">=</span><span class="n">max_match</span><span class="p">,</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="p">)</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="n">q</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span><span class="p">()</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>    <span class="n">q_children</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span><span class="p">()</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="n">node_number</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">string_tree</span><span class="p">):</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="n">char</span> <span class="o">=</span> <span class="n">string_tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="k">if</span> <span class="n">skip_char</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>            <span class="k">pass</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">string_tree</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="c1"># closing symbol of production</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="n">_node_number</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="n">_node_children</span> <span class="o">=</span> <span class="n">q_children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>            <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">_node_number</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_node_children</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="n">j</span> <span class="o">=</span> <span class="n">find_longest_match_func</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="n">sym</span> <span class="o">=</span> <span class="n">string_tree</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="n">node_number</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>                <span class="n">node_number</span><span class="p">,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                <span class="o">**</span><span class="p">{</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                    <span class="n">sym_name</span><span class="p">:</span> <span class="n">sym</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                    <span class="s2">&quot;terminal&quot;</span><span class="p">:</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                    <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                <span class="p">},</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">q</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_number</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>                <span class="n">q_children</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_number</span><span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="k">if</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">node_number</span><span class="p">)</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>                <span class="n">q_children</span><span class="o">.</span><span class="n">put</span><span class="p">([])</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">queue</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid string_tree&quot;</span><span class="p">)</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_all_edge_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_all_edge_data</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_all_edge_data" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_all_edge_data</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">key</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">private_edge_data</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Get edge attributes of this graph and all child graphs in one go.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>key</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The key of the attribute</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>scope</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The scope to be applied</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;all&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>private_edge_data</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to return data from graph copies as well.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>list</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>All data in a list.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="k">def</span> <span class="nf">get_all_edge_data</span><span class="p">(</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">private_edge_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">    Get edge attributes of this graph and all child graphs in one go.</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">        key (str): The key of the attribute</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        scope (str): The scope to be applied</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        private_edge_data (bool): Whether to return data from graph copies as well.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">        list: All data in a list.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>    <span class="k">assert</span> <span class="n">scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="o">=</span><span class="ow">not</span> <span class="n">private_edge_data</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="bp">self</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="p">]:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>            <span class="ow">or</span> <span class="n">graph</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="n">scope</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="o">.</span><span class="n">scope</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="p">):</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">edge_data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                <span class="k">if</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge_data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_dense_edges" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_dense_edges</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_dense_edges" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_dense_edges</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Returns the edge indices (i, j) that would make a fully connected
DAG without circles such that i &lt; j and i != j. Assumes nodes are
already created.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>list</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list of edge indices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="k">def</span> <span class="nf">get_dense_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">    Returns the edge indices (i, j) that would make a fully connected</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">    DAG without circles such that i &lt; j and i != j. Assumes nodes are</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">    already created.</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        list: list of edge indices.</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="n">nodes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">()))</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>                <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">return</span> <span class="n">edges</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_graph_representation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_graph_representation</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.get_graph_representation" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_graph_representation</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.cfg.Grammar" href="../cfg/#neps.search_spaces.architecture.cfg.Grammar">Grammar</a></span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>This functions takes an identifier and constructs the
(multi-variate) composition of the functions it describes.
Args:
    identifier (str): identifier
    grammar (Grammar): grammar
    flatten_graph (bool, optional): Whether to flatten the graph. Defaults to True.
Returns:
    nx.DiGraph: (multi-variate) composition of functions</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="k">def</span> <span class="nf">get_graph_representation</span><span class="p">(</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>    <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>    <span class="n">edge_attr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;This functions takes an identifier and constructs the</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">    (multi-variate) composition of the functions it describes.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        identifier (str): identifier</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        grammar (Grammar): grammar</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">        flatten_graph (bool, optional): Whether to flatten the graph. Defaults to True.</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">        nx.DiGraph: (multi-variate) composition of functions</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="k">def</span> <span class="nf">_skip_char</span><span class="p">(</span><span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>    <span class="k">def</span> <span class="nf">_get_sym_from_split</span><span class="p">(</span><span class="n">split</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>        <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="k">while</span> <span class="n">start_idx</span> <span class="o">&lt;</span> <span class="n">end_idx</span> <span class="ow">and</span> <span class="n">split</span><span class="p">[</span><span class="n">start_idx</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>            <span class="n">start_idx</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>        <span class="k">while</span> <span class="n">start_idx</span> <span class="o">&lt;</span> <span class="n">end_idx</span> <span class="ow">and</span> <span class="n">split</span><span class="p">[</span><span class="n">end_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>            <span class="n">end_idx</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>        <span class="k">return</span> <span class="n">split</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>    <span class="k">def</span> <span class="nf">to_node_attributed_edge_list</span><span class="p">(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>        <span class="n">edge_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="n">first_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">}</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="n">second_nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">}</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>        <span class="n">src</span> <span class="o">=</span> <span class="n">first_nodes</span> <span class="o">-</span> <span class="n">second_nodes</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>        <span class="n">tgt</span> <span class="o">=</span> <span class="n">second_nodes</span> <span class="o">-</span> <span class="n">first_nodes</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>        <span class="n">node_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>        <span class="n">edge_to_node_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">node_offset</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">edge_list</span><span class="p">)}</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>        <span class="n">node_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">:</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>            <span class="n">ni</span> <span class="o">=</span> <span class="n">edge_to_node_map</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>            <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>            <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>                <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">u</span><span class="p">,</span> <span class="n">ni</span><span class="p">))</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tgt</span><span class="p">:</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>                <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ni</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>            <span class="k">for</span> <span class="n">e_</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>                <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">),</span> <span class="n">edge_list</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>            <span class="p">):</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>                <span class="n">node_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">edge_to_node_map</span><span class="p">[</span><span class="n">e_</span><span class="p">],</span> <span class="n">ni</span><span class="p">))</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="k">return</span> <span class="n">node_list</span><span class="p">,</span> <span class="n">edge_to_node_map</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>    <span class="n">descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id_to_string_tree</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>    <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>        <span class="n">terminal_to_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># node-attr</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>        <span class="n">terminal_to_graph_nodes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>            <span class="n">k</span><span class="p">:</span> <span class="n">to_node_attributed_edge_list</span><span class="p">(</span><span class="n">edge_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">edge_list</span> <span class="k">else</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">edge_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_graph_edges</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>        <span class="p">}</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>        <span class="n">terminal_to_graph</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">terminal_to_graph_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="c1"># edge_to_node_map = {k: v[1] for k, v in terminal_to_graph_nodes.items()}</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>    <span class="n">q_nonterminals</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span><span class="p">()</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>    <span class="n">q_topologies</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span><span class="p">()</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>    <span class="n">q_primitives</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">LifoQueue</span><span class="p">()</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">descriptor</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)):</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>        <span class="k">if</span> <span class="n">_skip_char</span><span class="p">(</span><span class="n">split</span><span class="p">):</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>            <span class="k">continue</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>        <span class="n">sym</span> <span class="o">=</span> <span class="n">_get_sym_from_split</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>        <span class="k">if</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">terminals</span><span class="p">:</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>            <span class="n">is_topology</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="p">[</span><span class="n">sym</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="p">[</span><span class="n">sym</span><span class="p">],</span> <span class="n">AbstractTopology</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>            <span class="p">):</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>                <span class="n">is_topology</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="p">[</span><span class="n">sym</span><span class="p">],</span> <span class="n">partial</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">AbstractTopology</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>            <span class="p">):</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>                <span class="n">is_topology</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>            <span class="k">if</span> <span class="n">is_topology</span><span class="p">:</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>                <span class="n">q_topologies</span><span class="o">.</span><span class="n">put</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="p">[</span><span class="n">sym</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># is primitive operation</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>                <span class="n">q_primitives</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_to_op_names</span><span class="p">[</span><span class="n">sym</span><span class="p">])</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>                <span class="n">q_topologies</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># count number of primitives</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>        <span class="k">elif</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">grammar</span><span class="o">.</span><span class="n">nonterminals</span><span class="p">:</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>            <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown symbol </span><span class="si">{</span><span class="n">sym</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>        <span class="k">if</span> <span class="s2">&quot;)&quot;</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>            <span class="c1"># closing symbol of production</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>            <span class="k">while</span> <span class="s2">&quot;)&quot;</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>                <span class="k">if</span> <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">==</span> <span class="n">q_topologies</span><span class="o">.</span><span class="n">qsize</span><span class="p">():</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>                    <span class="n">topology</span><span class="p">,</span> <span class="n">number_of_primitives</span> <span class="o">=</span> <span class="n">q_topologies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>                    <span class="n">primitives</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>                        <span class="n">q_primitives</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>                        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_primitives</span><span class="p">)</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>                    <span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>                        <span class="n">topology</span> <span class="ow">in</span> <span class="n">terminal_to_graph</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>                        <span class="ow">and</span> <span class="n">terminal_to_graph</span><span class="p">[</span><span class="n">topology</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>                    <span class="p">):</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>                        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>                        <span class="c1"># edges = terminal_to_graph[topology]</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">partial</span><span class="p">):</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>                        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>                        <span class="n">composed_function</span> <span class="o">=</span> <span class="n">topology</span><span class="p">(</span><span class="o">*</span><span class="n">primitives</span><span class="p">)</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>                        <span class="n">node_attr_dag</span> <span class="o">=</span> <span class="n">composed_function</span><span class="o">.</span><span class="n">get_node_list_and_ops</span><span class="p">()</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>                        <span class="n">G</span> <span class="o">=</span> <span class="n">node_attr_dag</span>  <span class="c1"># TODO only works for DARTS for now</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">q_topologies</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>                        <span class="n">q_primitives</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">composed_function</span><span class="p">)</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>                        <span class="n">q_topologies</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>                <span class="n">_</span> <span class="o">=</span> <span class="n">q_nonterminals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>                <span class="n">split</span> <span class="o">=</span> <span class="n">split</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">q_topologies</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid descriptor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>    <span class="c1"># G = self.prune_unconnected_parts(G, src_node, sink_node)</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>    <span class="c1"># self._check_graph(G)</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.graph_to_self" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">graph_to_self</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.graph_to_self" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">graph_to_self</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">graph</span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span> <span class="n">clear_self</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Copies graph to self</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>graph</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>graph</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="networkx.DiGraph">DiGraph</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="k">def</span> <span class="nf">graph_to_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">clear_self</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Copies graph to self</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">        graph (nx.DiGraph): graph</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>    <span class="k">if</span> <span class="n">clear_self</span><span class="p">:</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.modules_str" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">modules_str</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.modules_str" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">modules_str</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Once the graph has been parsed, prints the modules as they appear in pytorch.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="k">def</span> <span class="nf">modules_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Once the graph has been parsed, prints the modules as they appear in pytorch.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parsed</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">]:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;Graph </span><span class="si">{}</span><span class="s2">:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{}</span><span class="se">\n</span><span class="s2">==========</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.num_input_nodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">num_input_nodes</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.num_input_nodes" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">num_input_nodes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>The number of input nodes, i.e. the nodes without an
incoming edge.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>int</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Number of input nodes.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="k">def</span> <span class="nf">num_input_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    The number of input nodes, i.e. the nodes without an</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    incoming edge.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        int: Number of input nodes.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.parse" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">parse</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.parse" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">parse</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Convert the graph into a neural network which can then
be optimized by pytorch.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    Convert the graph into a neural network which can then</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    be optimized by pytorch.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="k">for</span> <span class="n">node_idx</span> <span class="ow">in</span> <span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="k">if</span> <span class="s2">&quot;subgraph&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">][</span><span class="s2">&quot;subgraph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-subgraph_at(</span><span class="si">{</span><span class="n">node_idx</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">][</span><span class="s2">&quot;subgraph&quot;</span><span class="p">],</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="p">)</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">][</span><span class="s2">&quot;comb_op&quot;</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-comb_op_at(</span><span class="si">{</span><span class="n">node_idx</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">][</span><span class="s2">&quot;comb_op&quot;</span><span class="p">],</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                <span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="k">for</span> <span class="n">neigbor_idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node_idx</span><span class="p">):</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="n">edge_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">node_idx</span><span class="p">,</span> <span class="n">neigbor_idx</span><span class="p">)</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>            <span class="k">elif</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">get_embedded_ops</span><span class="p">():</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                <span class="k">for</span> <span class="n">primitive</span> <span class="ow">in</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">get_embedded_ops</span><span class="p">():</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>                        <span class="n">primitive</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-edge(</span><span class="si">{</span><span class="n">node_idx</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">neigbor_idx</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                <span class="n">edge_data</span><span class="o">.</span><span class="n">op</span><span class="p">,</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>            <span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_parsed</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prepare_discretization" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">prepare_discretization</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prepare_discretization" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prepare_discretization</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>In some cases the search space is manipulated before the final
discretization is happening, e.g. DARTS. In such chases this should
be defined in the search space, so all optimizers can call it.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="k">def</span> <span class="nf">prepare_discretization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">    In some cases the search space is manipulated before the final</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">    discretization is happening, e.g. DARTS. In such chases this should</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">    be defined in the search space, so all optimizers can call it.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prepare_evaluation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">prepare_evaluation</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prepare_evaluation" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prepare_evaluation</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>In some cases the evaluation architecture does not match the searched
one. An example is where the makro_model is extended to increase the
parameters. This is done here.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="k">def</span> <span class="nf">prepare_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    In some cases the evaluation architecture does not match the searched</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">    one. An example is where the makro_model is extended to increase the</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">    parameters. This is done here.</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prune_tree" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">prune_tree</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.prune_tree" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prune_tree</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">tree</span><span class="p">:</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">terminal_to_torch_map_keys</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="collections.abc.KeysView" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.KeysView">KeysView</a></span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">node_label</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Prunes unnecessary parts of parse tree, i.e., only one child</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>tree</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Parse tree</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="networkx.DiGraph">DiGraph</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="networkx.DiGraph">DiGraph</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nx.DiGraph: Pruned parse tree</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="k">def</span> <span class="nf">prune_tree</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">tree</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">terminal_to_torch_map_keys</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">KeysView</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">node_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;op_name&quot;</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prunes unnecessary parts of parse tree, i.e., only one child</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        tree (nx.DiGraph): Parse tree</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        nx.DiGraph: Pruned parse tree</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">visited</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="n">former_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">])</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="n">child</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="n">tree</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                    <span class="n">visited</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                    <span class="n">tree</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                    <span class="n">child</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="k">if</span> <span class="n">former_len</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="n">predecessor</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">])</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">predecessor</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                    <span class="n">tree</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">predecessor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                    <span class="n">old_children</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                    <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">old_children</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                    <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                        <span class="n">old_children</span><span class="p">[:</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                        <span class="o">+</span> <span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                        <span class="o">+</span> <span class="n">old_children</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                    <span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                    <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="n">tree</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="k">elif</span> <span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;terminal&quot;</span><span class="p">]</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="ow">and</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">node_label</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">terminal_to_torch_map_keys</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="p">):</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">predecessor</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">predecessor</span><span class="p">][</span><span class="s2">&quot;children&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="n">tree</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">return</span> <span class="n">tree</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">return</span> <span class="n">dfs</span><span class="p">(</span><span class="nb">set</span><span class="p">(),</span> <span class="n">tree</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_root</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.reset_weights" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reset_weights</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.reset_weights" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">reset_weights</span><span class="p">(</span><span class="n">inplace</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Resets the weights for the 'op' at all edges.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>inplace</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Do the operation in place or
return a modified copy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Returns:
    Graph: Returns the modified version of the graph.</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="k">def</span> <span class="nf">reset_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">    Resets the weights for the &#39;op&#39; at all edges.</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">        inplace (bool): Do the operation in place or</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">            return a modified copy.</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">        Graph: Returns the modified version of the graph.</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>    <span class="k">def</span> <span class="nf">weight_reset</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="n">m</span><span class="o">.</span><span class="n">reset_parameters</span><span class="p">()</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="n">graph</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">weight_reset</span><span class="p">)</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="k">return</span> <span class="n">graph</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_at_edges" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_at_edges</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_at_edges" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_at_edges</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Sets the attribute for all edges in this and any child graph</p>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="k">def</span> <span class="nf">set_at_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">    Sets the attribute for all edges in this and any child graph</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="o">=</span><span class="n">shared</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">]:</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating edges of graph </span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">edge_data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">is_final</span><span class="p">():</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                <span class="n">edge_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">shared</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_input</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_input" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_input</span><span class="p">(</span><span class="n">node_idxs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Route the input from specific parent edges to the input nodes of
this subgraph. Inputs are assigned in lexicographical order.</p>
<p>Example:
- Parent node (i.e. node where <code>self</code> is located on) has two
  incoming edges from nodes 3 and 5.
- <code>self</code> has two input nodes 1 and 2 (i.e. nodes without
  an incoming edge)
- <code>node_idxs = [5, 3]</code>
Then input of node 5 is routed to node 1 and input of node 3
is routed to node 2.</p>
<p>Similarly, if <code>node_idxs = [5, 5]</code> then input of node 5 is routed
to both node 1 and 2. Warning: In this case the output of another
incoming edge is ignored!</p>
<p>Should be used in a builder-like pattern: <code>'subgraph'=Graph().set_input([5, 3])</code></p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>node_idx</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The index of the nodes where the data is coming from.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Graph</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>self with input node indices set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="k">def</span> <span class="nf">set_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_idxs</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    Route the input from specific parent edges to the input nodes of</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    this subgraph. Inputs are assigned in lexicographical order.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    - Parent node (i.e. node where `self` is located on) has two</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">      incoming edges from nodes 3 and 5.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    - `self` has two input nodes 1 and 2 (i.e. nodes without</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">      an incoming edge)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    - `node_idxs = [5, 3]`</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Then input of node 5 is routed to node 1 and input of node 3</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    is routed to node 2.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    Similarly, if `node_idxs = [5, 5]` then input of node 5 is routed</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    to both node 1 and 2. Warning: In this case the output of another</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    incoming edge is ignored!</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    Should be used in a builder-like pattern: `&#39;subgraph&#39;=Graph().set_input([5, 3])`</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        node_idx (list): The index of the nodes where the data is coming from.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Graph: self with input node indices set.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">num_innodes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">assert</span> <span class="n">num_innodes</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="n">node_idxs</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="p">),</span> <span class="s2">&quot;Expecting node index for every input node. Excpected </span><span class="si">{}</span><span class="s2">, got </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">num_innodes</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_idxs</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_node_idxs</span> <span class="o">=</span> <span class="n">node_idxs</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_scope" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_scope</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.set_scope" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">recursively</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Sets the scope of this instance of the graph.</p>
<p>The function should be used in a builder-like pattern
<code>'subgraph'=Graph().set_scope("scope")</code>.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>scope</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the scope</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>recursively</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Also set the scope for all child graphs.
default True</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Graph</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>self with the setted scope.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="k">def</span> <span class="nf">set_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recursively</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    Sets the scope of this instance of the graph.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    The function should be used in a builder-like pattern</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    `&#39;subgraph&#39;=Graph().set_scope(&quot;scope&quot;)`.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        scope (str): the scope</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        recursively (bool): Also set the scope for all child graphs.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            default True</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        Graph: self with the setted scope.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="n">scope</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">if</span> <span class="n">recursively</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">g</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="n">scope</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.to_graph_repr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_graph_repr</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.to_graph_repr" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">to_graph_repr</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.graph.Graph" href="../graph/#neps.search_spaces.architecture.graph.Graph">Graph</a></span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="networkx.DiGraph">DiGraph</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Transforms NASLib-esque graph to NetworkX graph.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>graph</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>NASLib-esque graph.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="neps.search_spaces.architecture.graph.Graph" href="../graph/#neps.search_spaces.architecture.graph.Graph">Graph</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>edge_attr</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Transform to edge attribution or node attribution.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="networkx.DiGraph">DiGraph</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nx.DiGraph: edge- or node-attributed representation of computational graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/core_graph_grammar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="k">def</span> <span class="nf">to_graph_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms NASLib-esque graph to NetworkX graph.</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        graph (Graph): NASLib-esque graph.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        edge_attr (bool): Transform to edge attribution or node attribution.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        nx.DiGraph: edge- or node-attributed representation of computational graph.</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="k">if</span> <span class="n">edge_attr</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">][</span><span class="s2">&quot;op&quot;</span><span class="p">],</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">op_name</span><span class="o">=</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">][</span><span class="s2">&quot;op&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>                <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                    <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span><span class="p">:</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span><span class="p">]}</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                <span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">g</span><span class="o">.</span><span class="n">graph_type</span> <span class="o">=</span> <span class="s2">&quot;edge_attr&quot;</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">src</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">tgt</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="n">nof_edges</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="p">[</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span><span class="p">:</span> <span class="s2">&quot;input&quot;</span><span class="p">}),</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>                <span class="p">(</span><span class="n">nof_edges</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span><span class="p">:</span> <span class="s2">&quot;output&quot;</span><span class="p">}),</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="p">]</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="n">node_counter</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="n">open_edge</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">out_edges</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="n">g</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                    <span class="n">node_counter</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>                    <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span><span class="p">:</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_label</span><span class="p">]},</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="p">)</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>                <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">edge</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="n">src</span><span class="p">:</span>  <span class="c1"># special case for input node</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                    <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">node_counter</span><span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">tgt</span><span class="p">:</span>  <span class="c1"># special case of output node</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                    <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node_counter</span><span class="p">,</span> <span class="n">nof_edges</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                    <span class="n">u</span> <span class="ow">in</span> <span class="n">open_edge</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                <span class="p">):</span>  <span class="c1"># add edge between already seen nodes and new node</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                    <span class="k">for</span> <span class="n">node_count</span> <span class="ow">in</span> <span class="n">open_edge</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                        <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node_count</span><span class="p">,</span> <span class="n">node_counter</span><span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">open_edge</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                    <span class="n">open_edge</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_counter</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                    <span class="n">open_edge</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_counter</span><span class="p">]</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="n">node_counter</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="n">g</span><span class="o">.</span><span class="n">graph_type</span> <span class="o">=</span> <span class="s2">&quot;node_attr&quot;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_check_graph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="k">return</span> <span class="n">g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.unparse" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">unparse</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.unparse" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">unparse</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Undo the pytorch parsing by reconstructing the graph uusing the
networkx data structures.</p>
<p>This is done recursively also for child graphs.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Graph</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An unparsed shallow copy of the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="k">def</span> <span class="nf">unparse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    Undo the pytorch parsing by reconstructing the graph uusing the</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">    networkx data structures.</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">    This is done recursively also for child graphs.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">        Graph: An unparsed shallow copy of the graph.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="n">g</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="n">graph_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="n">graph_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="c1"># unparse possible child graphs</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>    <span class="c1"># be careful with copying/deepcopying here cause of shared edge data</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">graph_nodes</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="k">if</span> <span class="s2">&quot;subgraph&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;subgraph&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;subgraph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unparse</span><span class="p">()</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">graph_edges</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="n">Graph</span><span class="p">):</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">unparse</span><span class="p">())</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="c1"># create the new graph</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="c1"># Remember to add all members here to update. I know it is ugly but don&#39;t know better</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">graph_nodes</span><span class="o">.</span><span class="n">data</span><span class="p">())</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="n">g</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">graph_edges</span><span class="o">.</span><span class="n">data</span><span class="p">())</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="n">g</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="n">g</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="n">g</span><span class="o">.</span><span class="n">input_node_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_node_idxs</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">g</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="n">g</span><span class="o">.</span><span class="n">is_parsed</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="n">g</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="n">g</span><span class="o">.</span><span class="n">OPTIMIZER_SCOPE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OPTIMIZER_SCOPE</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="n">g</span><span class="o">.</span><span class="n">QUERYABLE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">QUERYABLE</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>    <span class="k">return</span> <span class="n">g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.update_edges" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update_edges</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.update_edges" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">update_edges</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">update_func</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">private_edge_data</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>This updates the edge data of this graph and all child graphs.
This is the preferred way to manipulate the edges after the definition
of the graph, e.g. by optimizers who want to insert their own op.
<code>update_func(current_edge_data)</code>. This way optimizers
can initialize and store necessary information at edges.</p>
<p>Note that edges marked as 'final' will not be updated here.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>update_func</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Function which accepts one argument called <code>current_edge_data</code>.
and returns the modified EdgeData object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#callable">callable</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>scope</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Can be "all" or list of scopes to be updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str or list(str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;all&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>private_edge_data</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If set to true, this means update_func will be
applied to all edges. THIS IS NOT RECOMMENDED FOR SHARED
ATTRIBUTES. Shared attributes should be set only once, we
take care it is syncronized across all copies of this graph.</p>
<p>The only usecase for setting it to true is when actually changing
<code>op</code> during the initialization of the optimizer (e.g. replacing it
with MixedOp or SampleOp)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="k">def</span> <span class="nf">update_edges</span><span class="p">(</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">update_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">private_edge_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="p">):</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">    This updates the edge data of this graph and all child graphs.</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">    This is the preferred way to manipulate the edges after the definition</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">    of the graph, e.g. by optimizers who want to insert their own op.</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">    `update_func(current_edge_data)`. This way optimizers</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">    can initialize and store necessary information at edges.</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">    Note that edges marked as &#39;final&#39; will not be updated here.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        update_func (callable): Function which accepts one argument called `current_edge_data`.</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">            and returns the modified EdgeData object.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">        scope (str or list(str)): Can be &quot;all&quot; or list of scopes to be updated.</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        private_edge_data (bool): If set to true, this means update_func will be</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            applied to all edges. THIS IS NOT RECOMMENDED FOR SHARED</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">            ATTRIBUTES. Shared attributes should be set only once, we</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">            take care it is syncronized across all copies of this graph.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            The only usecase for setting it to true is when actually changing</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            `op` during the initialization of the optimizer (e.g. replacing it</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">            with MixedOp or SampleOp)</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="n">Graph</span><span class="o">.</span><span class="n">_verify_update_function</span><span class="p">(</span><span class="n">update_func</span><span class="p">,</span> <span class="n">private_edge_data</span><span class="p">)</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>    <span class="k">assert</span> <span class="n">scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>    <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="o">=</span><span class="ow">not</span> <span class="n">private_edge_data</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="bp">self</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="p">]:</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>            <span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>            <span class="ow">or</span> <span class="n">scope</span> <span class="o">==</span> <span class="n">graph</span><span class="o">.</span><span class="n">scope</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="o">.</span><span class="n">scope</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">)</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>        <span class="p">):</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating edges of graph </span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>            <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">edge_data</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">edge_data</span><span class="o">.</span><span class="n">is_final</span><span class="p">():</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>                    <span class="n">edge</span> <span class="o">=</span> <span class="n">AttrDict</span><span class="p">(</span><span class="n">head</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">edge_data</span><span class="p">)</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>                    <span class="n">update_func</span><span class="p">(</span><span class="n">edge</span><span class="o">=</span><span class="n">edge</span><span class="p">)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_delete_flagged_edges</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.update_nodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">update_nodes</span>


<a href="#neps.search_spaces.architecture.core_graph_grammar.CoreGraphGrammar.update_nodes" class="headerlink" title="Permanent link">#</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">update_nodes</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">update_func</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">single_instances</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Update the nodes of the graph and its incoming and outgoing edges by iterating over the
graph and applying <code>update_func</code> to each of it. This is the
preferred way to change the search space once it has been defined.</p>
<p>Note that edges marked as 'final' will not be updated here.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>update_func</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Function that accepts three incoming parameters named
<code>node, in_edges, out_edges</code>.
    - <code>node</code> is a tuple (int, dict) containing the
      index and the attributes of the current node.
    - <code>in_edges</code> is a list of tuples with the index of
      the tail of the edge and its EdgeData.
    - `out_edges is a list of tuples with the index of
      the head of the edge and its EdgeData.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#callable">callable</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>scope</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Can be "all" or list of scopes to be updated. Only graphs
and child graphs with the specified scope are considered</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str or list(str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;all&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>single_instance</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If set to false, this means update_func will be
applied to nodes of all copies of a graphs. THIS IS NOT RECOMMENDED FOR SHARED
ATTRIBUTES, i.e. when manipulating the shared data of incoming or outgoing edges.
Shared attributes should be set only once, we take care it is syncronized across
all copies of this graph.</p>
<p>The only usecase for setting it to true is when actually changing
<code>op</code> during the initialization of the optimizer (e.g. replacing it
with MixedOp or SampleOp)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>neps/search_spaces/architecture/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="k">def</span> <span class="nf">update_nodes</span><span class="p">(</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">update_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">single_instances</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="p">):</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">    Update the nodes of the graph and its incoming and outgoing edges by iterating over the</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">    graph and applying `update_func` to each of it. This is the</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">    preferred way to change the search space once it has been defined.</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">    Note that edges marked as &#39;final&#39; will not be updated here.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        update_func (callable): Function that accepts three incoming parameters named</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            `node, in_edges, out_edges`.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">                - `node` is a tuple (int, dict) containing the</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">                  index and the attributes of the current node.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">                - `in_edges` is a list of tuples with the index of</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">                  the tail of the edge and its EdgeData.</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">                - `out_edges is a list of tuples with the index of</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">                  the head of the edge and its EdgeData.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">        scope (str or list(str)): Can be &quot;all&quot; or list of scopes to be updated. Only graphs</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            and child graphs with the specified scope are considered</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">        single_instance (bool): If set to false, this means update_func will be</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">            applied to nodes of all copies of a graphs. THIS IS NOT RECOMMENDED FOR SHARED</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">            ATTRIBUTES, i.e. when manipulating the shared data of incoming or outgoing edges.</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">            Shared attributes should be set only once, we take care it is syncronized across</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">            all copies of this graph.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">            The only usecase for setting it to true is when actually changing</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">            `op` during the initialization of the optimizer (e.g. replacing it</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">            with MixedOp or SampleOp)</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="k">assert</span> <span class="n">scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_child_graphs</span><span class="p">(</span><span class="n">single_instances</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">]:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>            <span class="n">scope</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="ow">or</span> <span class="n">graph</span><span class="o">.</span><span class="n">scope</span> <span class="o">==</span> <span class="n">scope</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="o">.</span><span class="n">scope</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">)</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="p">):</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating nodes of graph </span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="k">for</span> <span class="n">node_idx</span> <span class="ow">in</span> <span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                <span class="n">node</span> <span class="o">=</span> <span class="p">(</span><span class="n">node_idx</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">])</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>                <span class="n">in_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">node_idx</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>  <span class="c1"># (v, u, data)</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>                <span class="n">in_edges</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>                    <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">in_edges</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">is_final</span><span class="p">()</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>                <span class="p">]</span>  <span class="c1"># u is same for all</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>                <span class="n">out_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                    <span class="n">graph</span><span class="o">.</span><span class="n">out_edges</span><span class="p">(</span><span class="n">node_idx</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                <span class="p">)</span>  <span class="c1"># (v, u, data)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                <span class="n">out_edges</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>                    <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">out_edges</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">is_final</span><span class="p">()</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>                <span class="p">]</span>  <span class="c1"># v is same for all</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>                <span class="n">update_func</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="n">out_edges</span><span class="p">)</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_delete_flagged_edges</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../cfg/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Cfg">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Cfg
              </div>
            </div>
          </a>
        
        
          
          <a href="../crossover/" class="md-footer__link md-footer__link--next" aria-label="Next: Crossover">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Crossover
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.code.annotate", "content.code.copy", "navigation.footer", "navigation.sections", "toc.follow", "toc.integrate", "navigation.tabs", "navigation.tabs.sticky", "header.autohide", "search.suggest", "search.highlight", "search.share"], "search": "../../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>